<!DOCTYPE html>
<!-- saved from url=(0029)https://www.snucse.org/423653 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <title>스누씨</title>
    <link href="./2020-2_files/css" rel="stylesheet">
    <link href="./2020-2_files/nanumgothic.css" rel="stylesheet">
    <link rel="stylesheet" href="./2020-2_files/application.css">
  </head>
  <body>
    <div id="content"><div data-reactroot=""><div><header id="header"><div id="header-container"><div id="logo-container"><a id="logo" href="https://www.snucse.org/">SNUCSE</a></div><a id="top-menu-github-link" href="https://github.com/snucse/snucse" target="_blank" rel="noopener noreferrer">GitHub</a><a id="logout-link" href="https://www.snucse.org/423653#">로그아웃</a><a id="top-menu-activity-button" href="https://www.snucse.org/activities">활동</a><a id="search-link" href="https://www.snucse.org/search">검색</a></div></header><div id="main-container"><aside id="sidemenu-container"><section id="user-box"><img id="user-image" src="./2020-2_files/default.png"><h5 id="user-name"><a href="https://www.snucse.org/hscornelia"><!-- react-text: 67 -->김현수<!-- /react-text --><!-- react-text: 68 --> (<!-- /react-text --><!-- react-text: 69 -->hscornelia<!-- /react-text --><!-- react-text: 70 -->)<!-- /react-text --></a><!-- react-text: 14 --> <!-- /react-text --><a id="settings-link" href="https://www.snucse.org/settings">수정</a></h5></section><section id="following-profiles-box"><h5 id="following-profiles-title"><!-- react-text: 72 -->팔로우 중인 프로필<!-- /react-text --><a id="all-profiles-link" href="https://www.snucse.org/profiles">전체 프로필 보기</a></h5><ul id="following-profiles-list"><li><a href="https://www.snucse.org/snucom">돌소리</a></li><li><a href="https://www.snucse.org/notice">알립니다</a></li><li><a href="https://www.snucse.org/job">구인구직란</a></li><li><a href="https://www.snucse.org/_18">18학번 모임</a></li><li><a href="https://www.snucse.org/report">버그 제보 및 기능 제안</a></li><li><a href="https://www.snucse.org/hscornelia">김현수</a></li><li><a href="https://www.snucse.org/toorpds">족보</a></li></ul></section><section id="tag-cloud-box"><h5 id="tag-cloud-title">태그클라우드</h5><ul><li class="tag-cloud-tag-item"><a href="https://www.snucse.org/tags?tag=%EB%8B%AC%EB%A0%A5%EA%B2%8C%EC%8B%9C%ED%8C%90">달력게시판</a></li><li class="tag-cloud-tag-item"><a href="https://www.snucse.org/tags?tag=%ED%97%88%E2%98%86%EC%9D%BC%EC%A0%95%E2%98%86%EC%8A%B9">허☆일정☆승</a></li><li class="tag-cloud-tag-item"><a href="https://www.snucse.org/tags?tag=%EB%8D%95%EC%A7%88%ED%94%8C%EB%9E%9C">덕질플랜</a></li><li class="tag-cloud-tag-item"><a href="https://www.snucse.org/tags?tag=%EC%BB%B4%ED%93%A8%ED%84%B0%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D">컴퓨터프로그래밍</a></li><li class="tag-cloud-tag-item"><a href="https://www.snucse.org/tags?tag=%EA%B7%B8%EB%9E%98%ED%94%BD%EC%8A%A4">그래픽스</a></li><li class="tag-cloud-tag-item"><a href="https://www.snucse.org/tags?tag=%EB%A9%80%ED%8B%B0%EC%BD%94%EC%96%B4%20%EC%BB%B4%ED%93%A8%ED%8C%85">멀티코어 컴퓨팅</a></li></ul></section><section id="sidemenu-footer"><a href="https://id.snucse.org/Privacy.aspx" target="_blank" rel="noopener noreferrer">개인정보 처리방침</a></section></aside><div id="main"><section class="article-view"><div class="feed-article"><small class="article-date" title="2020년 10월 21일 오후 7시 39분"><div class="time">일 년 전</div></small><h5 class="article-title"><!-- react-text: 33 -->2020-2 System Programming 시스템 프로그래밍 에거 교수님 중간고사 필기 / 실기<!-- /react-text --><a class="article-profiles" href="https://www.snucse.org/toorpds">족보</a></h5><div class="article-main"><div class="article-writer-container"><img class="article-writer-image" src="./2020-2_files/thumb_61nleTrZJOL._SL1500_.jpg"><h5 class="article-writer-name"><a href="https://www.snucse.org/glglgozz">이인용</a></h5></div><div class="article-divider"></div><div class="article-content-container"><!-- react-empty: 42 --><div></div><div class="article-content"><div id="0ecb0954-5a87-4ebf-a55d-7d1192d0a065"><h1>2020 2학기 시스템 프로그래밍 (에거 교수님) 중간고사</h1>

<h2>필기</h2>

<h3>1. 16개 객관식 (각 0.5점) 여러 개 있을 수 있으니 여러 개면 여러 개 고르세요</h3>

<p>보기는 안 적었습니다.</p>

<ol>
<li>시스템 콜은 어디로 리턴하는가 i<em>curr? i</em>next? abort? ??</li>
<li>페이지 아웃된 페이지 접근해서 폴트가 났다 어디로 리턴하는가</li>
<li>malloc() 호출할 때 프로세서 모드는?</li>
<li>타이머 인터럽트는 싱크? 어싱크?</li>
<li>/o은 싱크? (뭐라고 적은 거지)</li>
<li>system call argument 패스 방식 (스택? 레지스터? 중에 뭐냐)</li>
<li>프로세스 끝난 거 뭐라고 부름 (언데드? 좀비? 중에 뭐냐)</li>
<li>6개의 함수 중에서 콜 성공했을 때 리턴하지 않는 함수들은? (fork(), execv(), exit(), open(), write() 등등)</li>
<li>6개의 함수 중(아까랑 같음)에서 성공했을 때 2번 리턴하는 함수는?</li>
<li>리눅스 x86_64에서 시스템 콜하는 인스트럭션은?</li>
<li>익명 파이프로 소통하지 못 하는 관계 1) 부모-자식 2) 형제 자매 3) 조부모-자식 4) 관계없는</li>
<li>the process receive signals ... 1) ? 2) ? 3) 최대한 빨리 4) 다음 인터럽트 때 ㅈㅅ</li>
<li>같은 타입의 시그널이 여러 번 왔다. 이건 큐에 쌓이는가? 1) yes 2) no</li>
<li>버퍼 I/O인 것은? 1) buffered I/O 2) standard I/O 3) unix I/O 4) 까먹음</li>
<li>UNIX 누가 만들었나</li>
<li>0.5점 받고 싶음? 네!</li>
</ol>

<h3>2. file descriptor와 fork, dup 등</h3>

<p>2개의 코드가 있는데<br>
C1은 <code>fd[0] = open(~); fd[1] = open(~);</code> 했고 (같은 파일)<br>
C2는 <code>fd[0] = open(~); fd[1] = dup(fd[0]);</code> 했음</p>

<p><code>
master = getpid();
// C1 C2 차이 코드
for (int i = 0; i &lt; 2; i++) {
  pid = fork();
    read(fd[pid ? 0 : 1], &amp;c, 1);
}
if (master == getpid()) {
  read(fd[0], &amp;c, 1);
    write(STDOUT_FILENO, &amp;c, 1);
}
</code></p>

<p>파일 내용이 <code>0123456789</code>일 때 C1과 C2의 출력과 왜 그렇게 나오는지 설명하세요.</p>

<h3>3. 리눅스 커널이 VM을 통해 fork()를 최적화한 방법</h3>

<p>리눅스 커널이 VM의 features를 이용하여 fork()를 효율적으로 구현한다. 이에 대해 상세하게 적으세요.</p>

<h3>4. fork() 장난질</h3>

<p>대략 아래와 같은 코드가 주어짐. (대충 적음)</p>

<p><code>
pid = getpid();
int i;
for (i =0; i &lt; 4; i++) {
  printf("%c%d\n", pid &gt; 0 ? 'p' : 'c', i);
  pid = fork();
  if (i % 2 == 0) {
    if (pid == 0) break;
  }
  else {
    if (pid &gt; 0) break;
  }
}
if (pid &gt; 0) waitpid(pid, NULL, 0);
printf("b%d\n", i);
</code></p>

<p>A) 생성되는 프로세스를 그리고 걔네가 뭘 프린트하는지 쓰세요.<br>
B) 프린트 순서가 어떻게 되는지, 가능한 경우의 개수는?</p>

<p>ㅁㄴㅇㄹ</p>

<h3>5. Implicit free list</h3>

<p>헤더와 푸터가 있는 블록? 시스템을 가진다고 할 때 boundary tag가 다음과 같다.</p>

<p><code>
[      size     | a b c ]
</code></p>

<p>a 비트는 항상 0,<br>
b 비트는 가까운 블록이 allocated 면 1 아니면 0,<br>
c 비트는 이 블록이 allocated 면 1 아니면 0을 의미한다.<br>
여기서 가깝다는 건 next higher address를 의미</p>

<p>메모리 구조가 아래와 갖고 가운데 친구를 free 했을 때 메모리가 어떻게 되는지 적으시오. 같으면 same이라고 쓰고 안 쓴 건 안 푼 거임</p>

<p><code>
높은 주소
[ 0x00000012 ]
[ 0x20121211 ]
[ 0x03010203 ]
[ 0x00000012 ]
[ 0x00000011 ]
[ 0x00000011 ] &lt;- 여기 free함
[ 0x00000011 ]
[ 0x00000011 ]
[ 0x00000013 ]
[ 0x19980522 ]
[ 0x19850916 ]
[ 0x00000013 ]
낮은 주소
</code></p>

<h3>6. explicit free list</h3>

<p>이건 못 베껴옴ㅋㅋ</p>

<p>address ordering 인 explicit free list 가 있고 1비트가 allocate 4비트부터 사이즈인 헤더 푸터 가진 구조.<br>
[프리 | 알록 | 프리 | <strong>알록</strong> | 알록 | 프리 | 알록] 그림이 있는데 (시퀀스는 틀렸을 수 있음)<br>
볼드 처리된 부분을 프리 했을 때 메모리 내용들이 어떻게 변하는지 적으세요.</p>

<h2>실기</h2>

<p>폴더 여러 개 입력 받고 그 중 duplicated된 파일들이 얼마나 있는지 통계를 보여주는 프로그램 만들기</p>

<ul>
<li>단계 별로 진행되며 뒤 단계는 앞 단계를 완성해야 이어서 구현할 수 있다</li>
<li>make init 을 하면 이전 단계 (A의 경우 initial 소스)가 복사된다. 여러 번 하면 큰일 남(?)</li>
<li>각 단계 별로 힌트들이 있다. 힌트 구성은 대충 1) 설명을 볼 건지 2) 수도 코드를 볼 건지 3) 필요한 시스템 함수들을 볼 건지 4) 정답을 볼 건지 같은 방식이고 받으면 점수가 깍인다. 예를 들어 C는 40점 만점인데 2번과 3번을 선택하면 -20점, 정답을 보면 -35점이다. 아무튼 D를 풀기 위해서는 C를 받고 넘어가는 편이 좋을 듯</li>
<li>적당한 테스트 세트를 줬고 <code>make test</code>로 짧은 것 실행 가능. doxygen 으로 된 문서를 찬찬히 읽어봐야 함 (스펙 다 적혀있음) 링크 파일은 제외할 건지 등등</li>
<li>해시 리스트를 관리하기 위한 자료 구조와 관련 메소드는 주어짐. 이것도 doxygen 문서를 보면 사용할 수 있음</li>
</ul>

<h3>A 10점</h3>

<p>메인 함수 짜기. argv[] 를 순회하면서 B의 <code>process_dir()</code> 를 호출하고 D의 <code>statistics()</code> 호출하기</p>

<h3>B 40점</h3>

<p>dir path를 받고 그 안의 파일들을 순회하면서 처리하기<br>
이 때 C의 md5sum() 을 호출하여 각 파일 해시 리스트에 추가하기</p>

<h3>C 40점</h3>

<p>md5sum() 함수 구현하기. md5sum 작업은 리눅스에 있는 /usr/bin/md5sum 을 사용하세요.</p>

<h3>D 30점</h3>

<p>순회하면서 얻은 list 를 포맷에 맞게 통계로 보여주기</p>

<h3>실기 정답(?)</h3>

<details>
<summary>각 단계 정답</summary>
A)<br>
해시 리스트를 초기화 한다. list = create_list();<br>
argc를 갖고 argv를 돌면서 process_dir()를 호출한다.<br>
마지막에 통계함수를 호출한다. statistics(list, numdir);<br>
해시 리스트를 제거한다. delete_list(list);<br>
<br>
B)<br>
opendir() 를 사용하여 연다.<br>
readdir() 를 사용하여 파일들을 순회한다.<br>
순회할 적에 .과 ..는 제외한다.<br>
폴더와 레귤러 파일이 아니면 건너뛴다.<br>
폴더면 path를 연결짓고 process_dir()를 재귀 호출한다.<br>
레귤러 파일이면 stat()을 사용하여 사이즈를 구하고<br>
asprintf()등을 이용하여 파일 path를 구하고 C의 md5sum()으로 호출한다.<br>
list에 파일 이름, path, size, hash 등을 넘겨주어 추가한다. add_list(list, path, name, size, md5sum(path, name));<br>
다 순회했으면 closedir() 를 사용하여 닫는다.<br>
<br>
C)<br>
fork() 한 뒤 execv() 계열을 사용하여 /usr/bin/md5sum 을 호출한다.<br>
이 때 parent 에서 해시 결과를 받아와야 하므로 프로세스 간 통신이 필요하다.<br>
이 경우 pipe를 사용한다.<br>
int fd[2];<br>
pipe(fd);<br>
<br>
pid_t pid = fork();<br>
if (pid &lt; 0) error;<br>
if (pid == 0) { // 자식<br>
// read end 를 닫는다.<br>
// write end 를 stdout 에 dup2 한다.<br>
// 적절한 파라미터로 execv() 한다. <br>
} else { // 부모<br>
// write end를 닫는다.<br>
// 읽는다. <br>
// wait 한다.<br>
// 받아온 길이 32짜리 해시를 리턴한다.<br>
}<br>
<br>
D)<br>
list를 돌면서 거기에 해시랑 파일 리스트가 잘 있는데 포맷에 맞게 잘 출력해준다<br>
</details>

<p><br></p>

<h3>첨언</h3>

<p>쉬웠다! 잘 봤다는 건 아님ㅋㅋ<br>
필기 5시 5분 시작 6시 20분 끝<br>
실기 7시 시작 9시 종료.. 였으나 준비 미흡으로 학생들에게 개인 비밀번호를 주는 데 시간을 잡아먹어 7시 40분 경 시작해서 9시 30분 종료로 변경, 그리고 30분 연장을 두 번 해서(학생들이 원해서) 10시 30분에 끝났다.</p>
</div></div></div></div><div class="recommend-container"><button class="recommend-button"><!-- react-text: 48 -->추천<!-- /react-text --><span class="recommend-count">0</span></button></div><div class="tag-container"><ul class="tag-list"><li class="tag-item"><a class="tag-item-name" href="https://www.snucse.org/tags?tag=%EC%8B%9C%EC%8A%A4%ED%85%9C%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%B0%8D"><span title="tagged by 이인용">시스템프로그래밍</span></a><button class="tag-item-delete-button">×</button></li></ul><section class="tag-form-container"><button class="show-tag-form-button">태그추가</button></section></div><div class="comment-container"><div class="comment-prefix"></div><div class="comment-main-container"><div class="comment-list-container"><div class="comment-list-controller"></div><ul class="comment-list"></ul></div><form class="comment-form"><div class="comment-input-container"><input class="comment-input"></div><button class="comment-submit-button">확인</button></form></div></div></div></section></div></div></div></div></div>
    <script src="./2020-2_files/application.js"></script>
  

</body></html>